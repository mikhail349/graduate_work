# Разработать сервис биллинга

Он должен позволять пользователям оформлять и отменять подписку на онлайн-кинотеатр.
С помощью подписки пользователь в будущем сможет получать доступ к различным фичам онлайн-кинотеатра. Например, смотреть фильмы в лучшем качестве и/или получать доступ к киноновинкам.

## Функциональные требования
### Создать базу данных, которая хранит:
1. Реестр пользователей.
2. Реестр платежных систем (далее - _ПС_).
3. Связь пользователя с его токеном из ПС.
4. Реестр видов подписок.
5. Реестр истории оформления и отмены подписок по каждому пользователю.

### Разработать админ-панель с функциями:
1. **Создание, редактирование и удаление подписок**
Каждая подписка состоит из названия, кода/ID, стоимости.
2. **Создание, редактирование и удаление ПС**
Каждая ПС состоит из названия.
2. **Просмотр реестра пользователей**.
3. **Просмотр истории оформления и отмены подписки по каждому пользователю**.

### Разработать API-сервис с эндпоинтами:
1. **Оформить подписку**
Передается access-токен ПС, код/ID подписки и ее цена. Переданная цена сопоставляется с актуальной ценой в БД. Это нужно для того, чтобы быть уверенными, что у пользователя спишется именно та сумма, которая отобразилась ему в интерфейсе.
2. **Отменить подписку**
Передается access-токен и код/ID подписки.

### Реализовать севрис по работе с ПС.
Реализовать абстрактный класс ПС и наследованный от него класс, который имитирует работу ПС. Архитектура должна позволять в будущем подключать новые ПС.

### Создать шедулер списания оплаты
Модуль должен работать в фоне и для каждого пользователя продлевать подписку каждый месяц. Для этого используется  таблица "Связь пользователя с его токеном из ПС".

## Нефункциональные требования
1. Поскольку сервису требуется аутентифицировать пользователей, необходимо реализовать валидацию токена, который генерируется сервисом авторизации. Для этого сервис биллинга должен иметь доступ к публичному RSA ключу.
2. Сервис будет хранить банковские карты пользователей. Чтобы обеспечить безопасность, необходимо хранить номер карты в зашифрованном виде, и не хранить CVV/CVC, а запрашивать его при оплате.